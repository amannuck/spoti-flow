(()=>{let n={title:"",artist:"",albumArt:"",isPlaying:!1,isMuted:!1};function a(){var t,e;try{const r=document.querySelector('[data-testid="context-item-info-title"]');r&&(n.title=r.textContent||"");const o=document.querySelector('[data-testid="context-item-info-subtitles"]');o&&(n.artist=o.textContent||"");const c=document.querySelector('[data-testid="cover-art-image"]');c&&c.src&&(n.albumArt=c.src);const u=document.querySelector('[data-testid="control-button-playpause"]');u&&(n.isPlaying=((t=u.getAttribute("aria-label"))==null?void 0:t.includes("Pause"))||!1);const s=document.querySelector('[data-testid="volume-bar-toggle-mute-button"]');return s&&(n.isMuted=((e=s.getAttribute("aria-label"))==null?void 0:e.includes("Unmute"))||!1),{success:!0,...n}}catch(r){return console.error("Error updating track info:",r),{success:!1,error:r.message}}}function i(t){try{let e;switch(t){case"play":case"pause":e='[data-testid="control-button-playpause"]';break;case"next":e='[data-testid="control-button-skip-forward"]';break;case"previous":e='[data-testid="control-button-skip-back"]';break;case"mute":case"unmute":e='[data-testid="volume-bar-toggle-mute-button"]';break;default:return{success:!1,error:"Unknown command"}}const r=document.querySelector(e);return r?(r.click(),setTimeout(a,500),{success:!0}):{success:!1,error:"Control button not found"}}catch(e){return console.error("Error controlling playback:",e),{success:!1,error:e.message}}}function l(){try{const t=document.querySelector('[data-testid="pip-toggle-button"]');return t?(t.click(),{success:!0}):{success:!1,error:"Mini player button not found"}}catch(t){return console.error("Error opening mini player:",t),{success:!1,error:t.message}}}const d=new MutationObserver(()=>{a()});function m(){const t=document.querySelector('[data-testid="now-playing-widget"]');t&&d.observe(t,{childList:!0,subtree:!0,attributes:!0})}a(),m(),chrome.runtime.onMessage.addListener((t,e,r)=>{if(t.action==="control"&&t.command){const o=i(t.command);return r(o),!0}if(t.action==="getTrackInfo"){const o=a();return r(o),!0}if(t.action==="openMiniPlayer"){const o=l();return r(o),!0}}),chrome.runtime.sendMessage({action:"contentScriptReady",tabId:window.location.href})})();
