(()=>{let n={title:"",artist:"",albumArt:"",isPlaying:!1};function c(){var e;try{const t=document.querySelector('[data-testid="context-item-info-title"]');t&&(n.title=t.textContent||"");const r=document.querySelector('[data-testid="context-item-info-subtitles"]');r&&(n.artist=r.textContent||"");const o=document.querySelector('[data-testid="cover-art-image"]');o&&o.src&&(n.albumArt=o.src);const a=document.querySelector('[data-testid="control-button-playpause"]');return a&&(n.isPlaying=((e=a.getAttribute("aria-label"))==null?void 0:e.includes("Pause"))||!1),{success:!0,...n}}catch(t){return console.error("Error updating track info:",t),{success:!1,error:t.message}}}function s(e){try{let t;switch(e){case"play":case"pause":t='[data-testid="control-button-playpause"]';break;case"next":t='[data-testid="control-button-skip-forward"]';break;case"previous":t='[data-testid="control-button-skip-back"]';break;default:return{success:!1,error:"Unknown command"}}const r=document.querySelector(t);return r?(r.click(),setTimeout(c,500),{success:!0}):{success:!1,error:"Control button not found"}}catch(t){return console.error("Error controlling playback:",t),{success:!1,error:t.message}}}const u=new MutationObserver(()=>{c()});function i(){const e=document.querySelector('[data-testid="now-playing-widget"]');e&&u.observe(e,{childList:!0,subtree:!0,attributes:!0})}c(),i(),chrome.runtime.onMessage.addListener((e,t,r)=>{if(e.action==="control"&&e.command){const o=s(e.command);return r(o),!0}if(e.action==="getTrackInfo"){const o=c();return r(o),!0}}),chrome.runtime.sendMessage({action:"contentScriptReady",tabId:window.location.href})})();
